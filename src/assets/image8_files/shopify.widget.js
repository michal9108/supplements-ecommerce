(()=>{"use strict";var t={962:function(t,e,r){function n(t,e){var r=u.default.getState(),n=r.getCart,o=r.getRouteVariants,s=r.getMerchantInfo,l=r.removeRouteProducts,f=r.renderUI;Promise.all([n(),o(),s(),(0,a.ajaxRequestHook)(),(0,a.fetchRequestHook)()]).then((function(){return l()})).then((function(){return(0,i.addCheckoutHooks)()})).then((function(){return f(t)})).then((function(){c.info("Shopify Widget is rendered!",{placement:t})})),e&&clearInterval(e)}var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},i=(Object.defineProperty(e,"__esModule",{value:!0}),r(286)),a=r(508),u=o(r(969)),c=(0,r(304).consoleLoggerAdapterFactory)().consoleLoggerAdapter,s=(window.routeWidgetOptimisticLock=!1,document.querySelectorAll(".route-div"));if(!window.routeWidgetOptimisticLock){if(0<s.length)for(var l=0;l<s.length;l++)0<s[l].childElementCount&&s[l].removeChild(s[l].lastChild),n(s[l],null);else var f=setInterval((function(){if(0<s.length)for(var t=0;t<s.length;t++)0<s[t].childElementCount&&s[t].removeChild(s[t].lastChild),n(s[t],f)}),500);window.routeWidgetOptimisticLock=!0}setInterval((function(){if(window.routeWidgetOptimisticLock)for(var t=document.querySelectorAll(".route-div"),e=0;e<t.length;e++)(t[e].childElementCount<=0||!window.routeWidgetInitialized)&&n(t[e],null)}),750)},329:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.global=void 0,e.global={shopifyServiceURL:"https://shopify.route.com",protectCoreURL:"https://protection-widget.route.com/protect.core.js"}},447:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createMerchantRepositoryFactory=void 0;var n=r(508),o=r(833),i=r(936),a=r(329);e.createMerchantRepositoryFactory=function(){var t=(0,n.getShopifyDomain)(),e=(0,o.createHttpClientWithRetry)();return new i.MerchantRepository({httpClient:e,shopifyServiceUrl:a.global.shopifyServiceURL,shopifyDomain:t})}},478:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createShopifyRepositoryFactory=void 0;var n=r(508),o=r(833),i=r(135);e.createShopifyRepositoryFactory=function(){var t=(0,n.getStoreDomain)(),e=(0,o.createHttpClientWithRetry)();return new i.ShopifyRepository({httpClient:e,storeDomain:t})}},751:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getCartUseCaseFactory=void 0;var n=r(786),o=r(478);e.getCartUseCaseFactory=function(){var t=(0,o.createShopifyRepositoryFactory)();return new n.GetCartUseCase(t)}},797:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.findSubtotalElements=e.isNumericString=e.parseCurrencyToNumeric=e.formatMoneyWithCurrency=void 0,e.formatMoneyWithCurrency=function(t,e,r){return void 0===r&&(r="USD"),e=e.toFixed(2),r=new Intl.NumberFormat("en-US",{currency:r,style:"currency"}).format(e),t.replace(/[0-9.,-]+/,r.replace(r[0],""))},e.parseCurrencyToNumeric=function(t){return parseFloat(t.replace(/[^0-9.-]+/g,"").replace(",",""))},e.isNumericString=function(t){return t=t.replace(/[^0-9.]/g,""),t=parseFloat(t),!isNaN(t)&&isFinite(t)},e.findSubtotalElements=function(){var t=[".totals__total-value",".Cart__Checkout span:nth-child(3)",".upsell-cart__subtotal",".ajaxcart__subtotal .money","button[type='submit'] .btn__content .ml-1",".subtotal .theme-money",".totals .totals__subtotal-value",".cart-subtotal .cart-subtotal__price",".go-cart-drawer__subtotal-price",".Cart__Total .money"],e=document.querySelectorAll(".route-div");if(0<e.length)for(var r=0;r<e.length;r++){var n=e[r];n.hasAttribute("data-subtotal-ref")&&(n=n.getAttribute("data-subtotal-ref"),t.push(n))}var o=document.querySelectorAll(t.join(","));return Array.from(o)}},286:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var n,o=0,i=e.length;o<i;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},u=this,c=(Object.defineProperty(e,"__esModule",{value:!0}),e.fetchProtectCoreScript=e.checkoutButtonEventDispatcher=e.deepCloneCheckoutButtons=e.addCheckoutHooks=e.dispatchElement=e.getExpressCheckoutButtons=e.getSubmitButtons=void 0,r(686)),s=r(304),l=a(r(969)),f=r(508),p=r(928),h=(0,s.consoleLoggerAdapterFactory)().consoleLoggerAdapter;function d(t){var e;window.routeSkipInterceptation=!0;try{if(t&&t.tagName&&"form"===t.tagName.toLowerCase())t.submit();else if(t&&t.tagName&&"a"===t.tagName.toLowerCase()&&null!=(e=t.getAttribute("href"))&&e.includes("checkout"))window.location.href="/checkout";else{var r=document.querySelectorAll(".route-div");if(0<r.length)for(var n=0;n<r.length;n++)if(r[n].hasAttribute("data-redirect-to-checkout"))return void(window.location.href="/checkout");t.click()}}catch(t){console.error("Shopify Widget: Error in dispatchElement:",t),window.location.href="/checkout"}}e.getSubmitButtons=function(){var t=document.querySelectorAll(['form[action="/cart"] input[type="submit"]','form[action="/cart"] button[type="submit"]','[name="checkout"]','[href="/checkout"]','[href="/checkout/"]','form[action="/checkout"] input[type="submit"]','form[action="/checkout"] button[type="submit"]',".checkout_button:not(p)",".btn--checkout",".ec-pdp-checkout-button",".rebuy-checkout-button",".rebuy-cart__checkout-button","#mu-checkout-button",'a[title="checkout"].btn-green-solid',".sidecart__checkout-button"].join(",")),e=(t=Array.prototype.slice.apply(t).filter((function(t){return"update"!==t.name})),document.querySelectorAll('button,input[type="submit"],input[type="button"],a'));e=Array.from(e).filter((function(t){return(t=(t.innerHTML||"").toLowerCase()).includes("checkout")||t.includes("check out")}));return i(i([],t,!0),e,!0).reduce((function(t,e){return t.includes(e)||t.push(e),t}),[])},e.getExpressCheckoutButtons=function(){var t=document.querySelectorAll(['[data-testid="ShopifyPay-button"]','[data-testid="GooglePay-button"]','form[action="https://payments.amazon.com/checkout/signin"] button[type="submit"]',".paypal-button",".sezzle-checkout-button",".rebuy-cart__shop-pay-button"].join(","));return Array.prototype.slice.apply(t).filter((function(t){return"update"!==t.name}))},e.dispatchElement=d;var y=!1,v=(window.routeInterceptedCheckoutHooks=!1,1);e.addCheckoutHooks=function(){var t;window.routeInterceptedCheckoutHooks?h.log("Checkout hooks are already being added. Skipping."):(t=0,window.routeInterceptedCheckoutHooks=!0,function r(){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:o.trys.push([0,4,5,6]),o.label=1;case 1:return t<50&&!y?(n=i(i([],(0,e.getSubmitButtons)(),!0),(0,e.getExpressCheckoutButtons)(),!0),(0,e.deepCloneCheckoutButtons)(n,v,e.checkoutButtonEventDispatcher),++t<=50&&(window.routeInterceptedCheckoutHooks=!0),[4,(0,f.sleep)(500)]):[3,3];case 2:return o.sent(),window.routeInterceptedRecalculate&&(t=0,window.routeInterceptedRecalculate=!1),[2,r()];case 3:return[3,6];case 4:return o.sent(),window.routeInterceptedCheckoutHooks=!1,[3,6];case 5:return 50<=t&&(window.routeInterceptedCheckoutHooks=!1),[7];case 6:return[2]}}))}))}())},e.deepCloneCheckoutButtons=function(t,e,r){return n(void 0,void 0,void 0,(function(){return o(this,(function(n){return t.forEach((function(t){var n,o;if(t.getAttribute("data-route-ref")||t.getAttribute("data-route-copy")){var i=t.getAttribute("data-route-ref");if((i=document.querySelector('[data-route-copy="'.concat(i,'"]')))&&null!==i||t.getAttribute("data-route-copy"))return;t.removeAttribute("data-route-ref"),t.removeAttribute("style")}t.hasAttribute("disabled")&&"disabled"==t.getAttribute("disabled")||"true"==t.getAttribute("disabled")||t.hasAttribute("class")&&t.classList.contains("disabled")||(n=t.parentNode,o=t.cloneNode(!0),setTimeout((function(){return n.insertBefore(o,t)}),250),t.setAttribute("style","display: none !important"),t.setAttribute("data-route-ref",e.toString()),o.removeAttribute("disabled"),o.setAttribute("data-route-copy",e.toString()),o.setAttribute("name",o.getAttribute("name")+"-route-"+e),"a"===(null==(i=null==o?void 0:o.tagName)?void 0:i.toLowerCase())&&null!=(i=null==o?void 0:o.getAttribute("href"))&&i.includes("checkout")&&(o.setAttribute("href","javascript:void(0);"),o.setAttribute("data-route-href","".concat(window.location.origin,"/checkout"))),o.addEventListener("click",(function(e){return r(t,e)})),e+=1)})),[2]}))}))},e.checkoutButtonEventDispatcher=function(t,e){var r;return n(this,void 0,void 0,(function(){var i,a,u,s,f,v,g,b,w,m=this;return o(this,(function(_){switch(_.label){case 0:return e.preventDefault(),e.stopImmediatePropagation(),i=document.getElementsByTagName("route-protect-widget"),a=i&&i[0]&&"true"==i[0].getAttribute("status")&&"no_coverage"!==i[0].getAttribute("payer")&&"merchant"!==i[0].getAttribute("payer"),u=i[0]&&i[0].getAttribute("quote").replace(/[^\d.]/g,""),h.log("Route Package Protection $".concat(u),{quote:u,placement:i}),f=l.default.getState().product.variants,!u||!f||f.length<=0?(d(t),[2,!1]):[4,l.default.getState().getClosestRouteVariant(parseFloat(u))];case 1:return _.sent(),s=window.Route.Protection.getGrafanaFaroWebClientFactory(),[4,l.default.getState().getCart()];case 2:return _.sent(),f=l.default.getState(),v=f.merchantId,g=f.storeDomain,b=f.cart,y||s.log(["Shopify Widget: Checkout button was triggered by customer"],{context:{merchantId:v,storeDomain:g,status:String(a),payer:i[0].getAttribute("payer"),quote:u,currency:null==b?void 0:b.currency,tagName:t.tagName||""}}),a?y?((null==(r=null==b?void 0:b.items)?void 0:r.find((function(t){return c.Assert.isProductFromRoute(t.vendor)})))&&d(t),[2]):(h.log("Shopify Widget: Checkout button was triggered!",{status:String(a),concurrency:y}),s.log(["Shopify Widget: Checkout button was triggered and it should add Route Package Protection"],{context:{merchantId:v,storeDomain:g,status:String(a),payer:i[0].getAttribute("payer"),quote:u,currency:null==b?void 0:b.currency,tagName:t.tagName||""}}),y=!0,w={maxRetries:10,delay:200,onSuccess:function(e,r){h.log("Shopify Widget: Route successfully added",e),window.Route.Protection.getGrafanaFaroWebClientFactory().log(["Shopify Widget: Route successfully added"],{context:{quantity:String(e.quantity),variantId:String(e.variantId),price:String(e.price/100),currency:null==b?void 0:b.currency,retryAttempt:String(r),tagName:t.tagName||""}}),setTimeout((function(){return d(t)}),250)},onError:function(e,r){window.Route.Protection.getGrafanaFaroWebClientFactory().log(["Shopify Widget: Error when trying to add Route Package Protection"],{context:{merchantId:v,storeDomain:g,status:String(a),payer:i[0].getAttribute("payer"),quote:u,currency:null==b?void 0:b.currency,error:(null==e?void 0:e.message)||JSON.stringify(e),retryAttempt:String(r),tagName:t.tagName||""}}),h.error("Shopify Widget: Error when trying to add Route Package Protection",e),setTimeout((function(){return d(t)}),250)}},[4,(0,p.retryUntil)((function(){return n(m,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,l.default.getState().addRouteProduct()];case 1:return[2,t.sent()]}}))}))}),w)]):[3,4];case 3:return _.sent(),[3,5];case 4:d(t),_.label=5;case 5:return[2,!1]}}))}))},e.fetchProtectCoreScript=function(t){return new Promise((function(e,r){if(null!=(n=window.Route)&&n.Protection)return e(u);var n=document.createElement("script");n.setAttribute("src",t),n.setAttribute("data-route-widget","true"),n.addEventListener("load",e),n.addEventListener("error",(function(t){r(new Error("Failed to load the Protect Core"))})),0<document.querySelectorAll("[data-route-widget]").length||document.body.appendChild(n)}))}},508:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},a=(Object.defineProperty(e,"__esModule",{value:!0}),e.fetchRequestHook=e.checkIfValidCartRequest=e.ajaxRequestHook=e.sleep=e.getShopifyDomain=e.getStoreDomain=void 0,r(286)),u=i(r(969)),c=(0,r(304).consoleLoggerAdapterFactory)().consoleLoggerAdapter;function s(){return n(this,void 0,void 0,(function(){var t,e,r,i,s,l,f,p,h,d=this;return o(this,(function(y){switch(y.label){case 0:return window.routeSkipInterceptation?[2]:[4,u.default.getState().getCart()];case 1:if(y.sent(),c.log("Recalculate was triggered by AJAX request!",{cart:u.default.getState().cart}),(0,a.addCheckoutHooks)(),window.routeInterceptedRecalculate=!0,0<(t=document.querySelectorAll("[data-route-ref]")).length)for(e=0;e<t.length;e++)if(r=t[e],i=r.getAttribute("data-route-ref"),(s=document.querySelector('[data-route-copy="'.concat(i,'"]')))&&null!==s){for(l=(0,a.getExpressCheckoutButtons)(),f=!0,p=0;p<l.length;p++)h=l[p],s===h&&(f=!1);f&&(s.remove(),r.removeAttribute("style"),r.removeAttribute("data-route-ref"),f=!0)}return v=function(){return n(d,void 0,void 0,(function(){var t,e;return o(this,(function(r){switch(r.label){case 0:t=document.querySelectorAll(".route-div"),e=0,r.label=1;case 1:return e<t.length?[4,u.default.getState().renderUI(t[e])]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},2,g=0,b=setInterval((function(){g<2?(v(),g++):clearInterval(b)}),400),[2]}var v,g,b}))}))}window.routeInterceptedXHR=!1,window.routeInterceptedFetch=!1,window.routeInterceptedRecalculate=!1,window.routeSkipInterceptation=!1,e.getStoreDomain=function(){return document.location.origin.replace(/^(https?:\/\/)/i,"").split("/")[0]},e.getShopifyDomain=function(){var t;if(window.Shopify)return window.Shopify.shop||(null==(t=window.Shopify.Checkout)?void 0:t.apiHost)||window.location.hostname},e.sleep=function(t){return new Promise((function(e){return setTimeout(e,t)}))},e.ajaxRequestHook=function(){if(window.routeInterceptedXHR)return c.log("Route already intercepted XHR hooks"),!1;var t=new Object,r=e.checkIfValidCartRequest,n=s;t.tempOpen=XMLHttpRequest.prototype.open,t.tempSend=XMLHttpRequest.prototype.send,t.callbackReady=function(t){void 0===t&&(t=!1),(!0===r(this.url)&&"post"===this.method.toLowerCase()||1==t)&&n()},t.callback=function(){},XMLHttpRequest.prototype.open=function(e,r){e=e||"",r=r||"",t.tempOpen.apply(this,arguments),t.method=e,t.url=r,"get"==e.toLowerCase()&&(t.data=r.split("?"),t.data=t.data[1])},XMLHttpRequest.prototype.send=function(e){e=e||"";var r=this,n=t.url;r.addEventListener("readystatechange",(function(){4===r.readyState&&t.callbackReady()})),n&&-1!==n.indexOf("/cart/change")&&t.callbackReady(!0),t.tempSend.apply(r,arguments),"post"==t.method.toLowerCase()&&(t.data=e),t.callback()},window.routeInterceptedXHR=!0},e.checkIfValidCartRequest=function(t){var e=new RegExp("/cart/:uid.js".replace(/:[^\s/]+/g,"([\\w-]+)")),r=new RegExp("/cart/:uid".replace(/:[^\s/]+/g,"([\\w-]+)"));return null!==(e=null!==t.match(e)?t.match(e):null!==t.match(r)?t.match(r):null)&&(-1===e.indexOf("/cart.js")||void 0)},e.fetchRequestHook=function(){if(window.routeInterceptedFetch)return c.log("Route already intercepted Fetch hooks"),!1;var t=window.fetch,r=e.checkIfValidCartRequest;window.fetch=function(e,n){return!0===r(e)&&s(),t.apply(this,arguments)},window.routeInterceptedFetch=!0}},928:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}};Object.defineProperty(e,"__esModule",{value:!0}),e.retryUntil=void 0,e.retryUntil=function(t,e){return r(void 0,void 0,void 0,(function(){var r,o,i,a,u,c;return n(this,(function(n){switch(n.label){case 0:r=void 0===(r=(a=e||{}).maxRetries)?3:r,i=a.delay,o=void 0===i?250:i,i=a.onSuccess,a=a.onError,u=0,n.label=1;case 1:if(!(u<r))return[3,7];n.label=2;case 2:return n.trys.push([2,4,,6]),[4,t()];case 3:return c=n.sent(),null!=i&&i(c,u),[2,c];case 4:return c=n.sent(),null!=a&&a(c,u),[4,new Promise((function(t){return setTimeout(t,o)}))];case 5:return n.sent(),[3,6];case 6:return u++,[3,1];case 7:throw new Error("Failed to retry after ".concat(r," attempts"))}}))}))}},314:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.createCartSlice=void 0,r(751));e.createCartSlice=function(t,e){return{getCart:function(){return n(void 0,void 0,void 0,(function(){var e,r,n,a,u,c,s,l,f,p,h;return o(this,(function(o){switch(o.label){case 0:return[4,(0,i.getCartUseCaseFactory)().execute()];case 1:return h=o.sent(),e=h.itemsCount,r=h.items,n=h.itemsSubtotalPrice,a=h.originalTotalPrice,u=h.requiresShipping,c=h.token,s=h.totalDiscount,l=h.totalPrice,f=h.currency,p=h.subtotal,h=h.attributes,t({cart:{token:c,itemsCount:e,items:r,itemsSubtotalPrice:n,originalTotalPrice:a,requiresShipping:u,totalDiscount:s,totalPrice:l,subtotal:p,currency:f,attributes:h}}),[2]}}))}))}}}},691:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.createMerchantSlice=void 0,r(686)),a=r(418),u=r(447),c=r(508),s=r(935),l=(0,u.createMerchantRepositoryFactory)();e.createMerchantSlice=function(t,e){return{getMerchantInfo:function(){return n(void 0,void 0,void 0,(function(){var e,r,n,u,f;return o(this,(function(o){switch(o.label){case 0:return e="route-merchant-info",r=(0,a.createCacheClient)(),n=r.get(e),i.Assert.isNotNullOrEmpty(n)&&i.Assert.isNotNullOrEmpty(n.merchantId)&&i.Assert.isNotNullOrEmpty(n.storeName)?[2,t({storeName:n.storeName,merchantId:n.merchantId})]:[4,new s.GetMerchantInfoUseCase(l).execute({shopifyDomain:(0,c.getShopifyDomain)()})];case 1:return n=o.sent(),u=n.merchantId,f=n.storeName,u&&f&&i.Assert.isNotNullOrEmpty(u)&&i.Assert.isNotNullOrEmpty(f)&&r.set(e,{merchantId:u,storeName:f},6048e5),[2,t({storeName:f,merchantId:u})]}}))}))}}}},960:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.createProductSlide=e.initialProductState=void 0,r(418)),a=r(478),u=r(922),c=r(354),s=r(584),l=r(996),f=(0,a.createShopifyRepositoryFactory)();e.initialProductState={product:{variants:[]},featuredProduct:{id:"",price:0}},e.createProductSlide=function(t,e){return{addRouteProduct:function(){return n(void 0,void 0,void 0,(function(){var t;return o(this,(function(r){return t=e().featuredProduct.id,[2,new u.AddRouteVariantUseCase(f).execute({productId:t})]}))}))},removeRouteProducts:function(){return n(void 0,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return t=e().cart,window.routeSkipInterceptation?[2]:[4,new l.RemoveAllRouteVariantsUseCase(f).execute({cart:t})];case 1:return r.sent()&&window.location.reload(),[2]}}))}))},getClosestRouteVariant:function(r){return n(void 0,void 0,void 0,(function(){var n,i;return o(this,(function(o){return i=e().product,i=(new c.GetClosestRouteVariantUseCase).execute({quote:r,variants:i.variants}),n=i.id,i=i.price,[2,t({featuredProduct:{id:n,price:i}})]}))}))},getRouteVariants:function(){return n(void 0,void 0,void 0,(function(){var r,n,a;return o(this,(function(o){switch(o.label){case 0:return r=(0,i.createCacheClient)(),n="route-product-info",(a=r.get(n))&&a.variants&&0<a.variants.length?(t({product:{variants:a.variants}}),[2]):[4,new s.GetRouteVariantsUseCase(f).execute({shopifyDomain:e().shopifyDomain})];case 1:return(a=o.sent())&&0<a.length&&r.set(n,{variants:a},864e5),t({product:{variants:a}}),[2]}}))}))}}}},640:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},u=(Object.defineProperty(e,"__esModule",{value:!0}),e.convertAlignment=e.buildTheming=e.convertStatus=e.createWidgetSlice=void 0,r(478)),c=r(329),s=r(797),l=r(286),f=r(62),p=r(212),h=a(r(969)),d=a(r(147)),y=(0,u.createShopifyRepositoryFactory)();window.routeWidgetInitialized=!1,e.createWidgetSlice=function(t,r){return{renderUI:function(n){return o(void 0,void 0,void 0,(function(){var a,u,v,g;return i(this,(function(b){switch(b.label){case 0:return a=r(),u=a.storeDomain,v=a.merchantId,g=a.storeName,[4,(0,l.fetchProtectCoreScript)("".concat(c.global.protectCoreURL,"?shop=").concat(u)).then((function(){return o(void 0,void 0,void 0,(function(){var a,c,b,w,m,_;return i(this,(function(S){switch(S.label){case 0:return[4,r().getCart()];case 1:return S.sent(),a=r().cart,b=r().product.variants,c=a.subtotal/100,b.length<=0?[2]:[4,new f.GetToggleStatusUseCase(y).execute()];case 2:return b=S.sent(),m=(0,e.convertStatus)(b),w=n.hasAttribute("desktop-align")?n.getAttribute("desktop-align"):void 0,_=n.hasAttribute("dark-ui"),m={app:{name:d.default.name,version:d.default.version,platformId:"shopify"},storeDomain:u,subtotal:c,currency:a.currency,environment:window.Route.Environment.Production,merchantId:v,storeName:g,cartRef:a.token,status:m,theming:(0,e.buildTheming)(_,w)},window.Route.Protection.render(m),null!=(_=r().middleware)&&_.rendered||(window.Route.Protection.on("get_quote",(function(t){var e=t.quote;return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(o){switch(o.label){case 0:return t=parseFloat(e.premium.amount),[4,h.default.getState().getClosestRouteVariant(t)];case 1:return o.sent(),window.Route.Protection.forceUpdateQuote(r().featuredProduct.price,!1),"merchant"!=e.paymentResponsible.type&&"no_coverage"!=e.paymentResponsible.type?[3,3]:[4,h.default.getState().removeRouteProducts()];case 2:o.sent(),o.label=3;case 3:return"customer"==e.paymentResponsible.type&&(t=h.default.getState().cart,n="checked"==e.paymentResponsible.toggleState,t&&t.attributes&&t.attributes.hasOwnProperty("route_toggle_state")&&(n=1==Number(t.attributes.route_toggle_state)),h.default.getState().renderSubtotalDinamicallyUI({toggleState:n})),setTimeout((function(){var t,e=window.Route.Protection.getGrafanaFaroWebClientFactory(),n=h.default.getState().cart;0==(0,l.getSubmitButtons)().length&&n&&0<n.itemsCount&&(t=(n=r()).merchantId,n=n.storeDomain,e.log(["Shopify Widget: Missing Checkout Button to attach event"],{context:{merchantId:t,storeDomain:n}}))}),4e3),[2]}}))}))})),window.Route.Protection.on("status_change",(function(t){return o(this,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return[4,new p.SetToggleStatusUseCase(y).execute(t.to)];case 1:return r.sent(),(e=(0,l.getExpressCheckoutButtons)())&&0<e.length&&0==t.to?[4,h.default.getState().removeRouteProducts()]:[3,3];case 2:r.sent(),r.label=3;case 3:return 0<(0,s.findSubtotalElements)().length?[4,h.default.getState().getCart()]:[3,5];case 4:r.sent(),h.default.getState().renderSubtotalDinamicallyUI({toggleState:1==t.to}),r.label=5;case 5:return[2]}}))}))})),window.routeWidgetInitialized=!0,t({middleware:{rendered:!0}})),[2]}}))}))})).catch((function(t){console.log("Error loading Route Protect Core script",t)}))];case 1:return b.sent(),[2]}}))}))},renderSubtotalDinamicallyUI:function(t){return o(void 0,void 0,void 0,(function(){var e,n,o,a,u,c;return i(this,(function(i){return 0!=(e=(0,s.findSubtotalElements)()).length&&window.routeWidgetInitialized&&(n=r(),a=n.cart,n=n.featuredProduct,o=a.currency,a=a.totalPrice,"USD"===o)&&(u=n.price,c=a/100,e.forEach((function(e){var r=e.innerHTML,n=t.toggleState?c+u:c;n=(0,s.formatMoneyWithCurrency)(r,n,o);(0,s.parseCurrencyToNumeric)(n)<=c&&(n=(0,s.formatMoneyWithCurrency)(r,c,o)),(0,s.isNumericString)(n)&&(e.innerHTML=n)}))),[2]}))}))}}},e.convertStatus=function(t){switch(t){case!0:return window.Route.Coverage.ActiveByDefault;case!1:return window.Route.Coverage.InactiveByDefault}},e.buildTheming=function(t,r){return r=(0,e.convertAlignment)(r),n(n({},t&&{mode:window.Route.Theme.Mode.DarkMode}),r&&{alignment:r})},e.convertAlignment=function(t){switch(t){case"left":return window.Route.Theme.Alignment.Left;case"center":return window.Route.Theme.Alignment.Center;case"right":return window.Route.Theme.Alignment.Right}}},969:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=(Object.defineProperty(e,"__esModule",{value:!0}),r(148)),i=r(508),a=r(960),u=r(314),c=r(691),s=r(640),l=n({shopifyDomain:(0,i.getShopifyDomain)(),storeDomain:(0,i.getStoreDomain)()},a.initialProductState);r=(0,o.createStore)((function(t,e){return n(n(n(n(n({},l),(0,a.createProductSlide)(t,e)),(0,u.createCartSlice)(t,e)),(0,c.createMerchantSlice)(t,e)),(0,s.createWidgetSlice)(t,e))}));e.default=r},786:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.GetCartUseCase=void 0,i.prototype.execute=function(){return r(this,void 0,void 0,(function(){var t,e,r,o,i,a,u,c,s,l,f,p;return n(this,(function(n){switch(n.label){case 0:return[4,this.shopifyRepository.getCart()];case 1:return l=n.sent(),t=l.itemsCount,e=l.items,r=l.itemsSubtotalPrice,o=l.originalTotalPrice,i=l.requiresShipping,a=l.token,u=l.totalDiscount,c=l.totalPrice,s=l.currency,l=l.attributes,f=0,e&&0<e.length&&(p=e.filter((function(t){return t.requires_shipping&&"route"!==(null==(t=t.vendor)?void 0:t.toLowerCase())})),f=p.reduce((function(t,e){return t+(e.original_line_price||e.final_line_price)}),0)),[2,{itemsCount:t,items:e,itemsSubtotalPrice:r,originalTotalPrice:o,requiresShipping:i,token:a,totalDiscount:u,totalPrice:c,currency:s,subtotal:f,attributes:l}]}}))}))},i);function i(t){this.shopifyRepository=t}e.GetCartUseCase=o},935:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.GetMerchantInfoUseCase=void 0,r(686));function a(t){this.merchantRepository=t}a.prototype.execute=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:if(!t)throw new Error("Input is required");if(i.Assert.isNullOrEmpty(t.shopifyDomain))throw new Error("Shopify domain is required");if(i.Assert.isUrl(t.shopifyDomain))return[4,this.merchantRepository.getMerchantInfo()];throw new Error("Shopify domain is invalid");case 1:return[2,{merchantId:(e=r.sent()).merchantId,storeName:e.storeName}]}}))}))},e.GetMerchantInfoUseCase=a},922:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.AddRouteVariantUseCase=void 0,r(686));function a(t){this.shopifyRepository=t}a.prototype.execute=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:if(!t)throw new Error("Input is required");if(i.Assert.isNullOrEmpty(t.productId))throw new Error("ProductID is required");if(i.Assert.isNotNumber(t.productId))throw new Error("ProductID must be a number");return e={items:[{id:t.productId,quantity:1}]},window.routeSkipInterceptation=!0,[4,this.shopifyRepository.addCart(e)];case 1:if(e=r.sent().items,window.routeSkipInterceptation=!1,0===e.length)throw new Error("Product not added successfully to the cart");return[2,Promise.resolve({productId:e[0].id,quantity:e[0].quantity,variantId:e[0].variant_id,price:e[0].price})]}}))}))},e.AddRouteVariantUseCase=a},354:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GetClosestRouteVariantUseCase=void 0;var n=r(686);function o(){}o.prototype.execute=function(t){if(n.Assert.isNullOrEmpty(t))throw new Error("Missing Input");if(n.Assert.isNullOrEmpty(t.quote))throw new Error("Missing Quote");if(n.Assert.isNullOrEmpty(t.variants))throw new Error("Missing Variants");var e=t.quote,r=t.variants;if(e<=r[0].price)return{id:r[0].id,price:r[0].price};if(e>=r[r.length-1].price)return{id:r[r.length-1].id,price:r[r.length-1].price};for(var o=0,i=r.length-1;o<i;){var a=Math.floor((o+i)/2);if(r[a].price===e)return{id:r[a].id,price:r[a].price};r[a].price<e?o=a+1:i=a}return{id:(t=Math.abs(e-r[o].price)<=Math.abs(e-r[i].price)?r[o]:r[i]).id,price:t.price}},e.GetClosestRouteVariantUseCase=o},584:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},a=(Object.defineProperty(e,"__esModule",{value:!0}),e.GetRouteVariantsUseCase=void 0,r(686));function u(t){this.shopifyApiRepository=t}u.prototype.execute=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:if(a.Assert.isNullOrEmpty(t))throw new Error("Missing Input");if(a.Assert.isNullOrEmpty(t.shopifyDomain))throw new Error("Missing Shopify Domain");if(a.Assert.isUrl(t.shopifyDomain))return[4,this.shopifyApiRepository.getRouteVariants()];throw new Error("Missing valid Shopify Domain or Store Domain");case 1:return[2,e.sent().map((function(t){return n(n({},t),{id:t.id,price:Number(t.price)/100})}))]}}))}))},e.GetRouteVariantsUseCase=u},996:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.RemoveAllRouteVariantsUseCase=void 0,r(686));function a(t){this.shopifyApiRepository=t}a.prototype.execute=function(t){return n(this,void 0,void 0,(function(){var e,r,n,a;return o(this,(function(o){switch(o.label){case 0:if(i.Assert.isNullOrEmpty(t.cart))throw new Error("Cart is null or empty");for(e=t.cart.items,r={updates:{}},n=0;n<e.length;n++)i.Assert.isProductFromRoute(e[n].vendor)&&(r.updates[e[n].variant_id]=0);if(!i.Assert.isNotNullOrEmpty(r.updates))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.shopifyApiRepository.updateCart(r)];case 2:return o.sent(),[2,!0];case 3:return a=o.sent(),console.log("Shopify Widget: Error removing all Route Items from cart",a),[3,4];case 4:return[2,!1]}}))}))},e.RemoveAllRouteVariantsUseCase=a},62:function(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.GetToggleStatusUseCase=void 0,r(686));function a(t){this.shopifyRepository=t}a.prototype.execute=function(){var t;return n(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return[4,this.shopifyRepository.getCart()];case 1:return e=r.sent(),i.Assert.isNullOrEmpty(e)||i.Assert.isNullOrEmpty(null==(t=e.attributes)?void 0:t.route_toggle_state)?[2,void 0]:[2,1==Number(null==(t=e.attributes)?void 0:t.route_toggle_state)]}}))}))},e.GetToggleStatusUseCase=a},212:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.SetToggleStatusUseCase=void 0,i.prototype.execute=function(t){return r(this,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:return e={attributes:{route_toggle_state:t}},window.routeSkipInterceptation=!0,[4,this.shopifyRepository.updateCart(e)];case 1:return e=r.sent(),window.routeSkipInterceptation=!1,[2,e&&e.attributes&&e.attributes.route_toggle_state==t]}}))}))},i);function i(t){this.shopifyRepository=t}e.SetToggleStatusUseCase=o},686:(t,e)=>{function r(){}Object.defineProperty(e,"__esModule",{value:!0}),e.Assert=void 0,r.isNullOrEmpty=function(t){return"object"==typeof t&&null!==t?0===Object.keys(t).length:null==t||""===t},r.isNotNullOrEmpty=function(t){return!this.isNullOrEmpty(t)},r.isNotNumber=function(t){return isNaN(t)},r.isValidShopifyDomain=function(t){return t&&""!==t&&t.includes(".myshopify.com")},r.isUrl=function(t){return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)},r.isProductFromRoute=function(t){return t&&"route"===t.trim().toLowerCase()},e.Assert=r},324:(t,e)=>{function r(t,e,r,n,o,i){if(this.id=t,this.title=e,this.handle=r,this.price=n,this.quantity=o,this.variants=i,!this.id)throw new Error("Missing Product ID");if(!this.title)throw new Error("Missing Product Title");if(!this.handle)throw new Error("Missing Product Handle");if(!this.price)throw new Error("Missing Product Price");if(!this.quantity)throw new Error("Missing Product Quantity");if(!this.variants)throw new Error("Missing Product Variants")}Object.defineProperty(e,"__esModule",{value:!0}),e.Product=void 0,r.prototype.getProductVariants=function(){return this.variants},e.Product=r},507:(t,e)=>{function r(t){void 0===t&&(t=window.localStorage),this.client=t}Object.defineProperty(e,"__esModule",{value:!0}),e.CacheClient=void 0,r.prototype.get=function(t){var e,r=this.client.getItem(t);return r?(e=(r=JSON.parse(r)).value,(r=r.ttl)&&Date.now()>r?(this.client.removeItem(t),null):e):null},r.prototype.set=function(t,e,r){r=Date.now()+r,e=JSON.stringify({value:e,ttl:r}),this.client.setItem(t,e)},r.prototype.delete=function(t){var e=this;return new Promise((function(r){e.client.removeItem(t),r()}))},r.prototype.clear=function(){var t=this;return new Promise((function(e){t.client.clear(),e()}))},e.CacheClient=r},418:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createCacheClient=void 0;var n=r(507);e.createCacheClient=function(){return new n.CacheClient(window.localStorage)}},308:function(t,e){var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},n=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.HttpClient=void 0,a.prototype.request=function(t,e,r){return n(this,void 0,void 0,(function(){var i=this;return o(this,(function(a){return this._retryStrategy?[2,this._retryStrategy.execute((function(){return n(i,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this._performRequest(t,e,r)];case 1:return[2,n.sent()]}}))}))}))]:[2,this._performRequest(t,e,r)]}))}))},a.prototype._performRequest=function(t,e,i){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return[4,fetch(e,r({method:t},i))];case 1:if((n=o.sent()).ok)return[2,n];throw new Error("Request failed with status ".concat(n.status))}}))}))},a.prototype.get=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request("GET",t,e)]}))}))},a.prototype.post=function(t,e){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,this.request("POST",t,e)]}))}))},a);function a(t){this._retryStrategy=t._retryStrategy}e.HttpClient=i},192:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.HttpClientBuilder=void 0;var n=r(308),o=r(813);function i(){}i.prototype.withRetryStrategy=function(t){return this._retryStrategy=new o.HttpRetryStrategy(t),this},i.prototype.withMockHttpClient=function(t){return this._mockedHttpClient=t,this},i.prototype.build=function(){return this._mockedHttpClient||new n.HttpClient(this)},e.HttpClientBuilder=i},833:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createHttpClientWithRetry=e.createHttpClient=void 0;var n=r(192);e.createHttpClient=function(t){var e=new n.HttpClientBuilder;return(t?e.withRetryStrategy(t):e).build()},e.createHttpClientWithRetry=function(t){var e=new n.HttpClientBuilder;return(t?e.withRetryStrategy(t):e.withRetryStrategy({maxRetries:3,retryDelayMs:1e3,backoffFactor:2})).build()}},813:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.HttpRetryStrategy=void 0,i.prototype.execute=function(t){return r(this,void 0,void 0,(function(){var e,r,o,i,a,u;return n(this,(function(c){switch(c.label){case 0:e=0,a=this.config,r=a.maxRetries,o=a.retryDelayMs,i=a.backoffFactor,a=function(){var a,u,c;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,4]),a={},[4,t()];case 1:return[2,(a.value=n.sent(),a)];case 2:if(u=n.sent(),r<=++e)throw new Error("Function failed after ".concat(r," retries: ").concat(u.message));return c=Math.pow(i,e-1)*o,[4,new Promise((function(t){return setTimeout(t,c)}))];case 3:return n.sent(),[3,4];case 4:return[2]}}))},c.label=1;case 1:return e<=r?[5,a()]:[3,3];case 2:return"object"==typeof(u=c.sent())?[2,u.value]:[3,1];case 3:return[2]}}))}))},i.prototype.getConfig=function(){return this.config},i);function i(t){this.config={maxRetries:(null==t?void 0:t.maxRetries)||3,retryDelayMs:(null==t?void 0:t.retryDelayMs)||1e3,backoffFactor:(null==t?void 0:t.backoffFactor)||2}}e.HttpRetryStrategy=o},591:(t,e)=>{function r(){this.consoleLogger=console,this.icons={INFO:"",ERROR:"",WARN:"",LOG:"",DEBUG:""}}Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleLoggerAdapter=void 0,r.prototype.info=function(t,e){this.logMessage(this.consoleLogger.info.bind(this.consoleLogger),"INFO",t,e)},r.prototype.error=function(t,e){this.logMessage(this.consoleLogger.error.bind(this.consoleLogger),"ERROR",t,e)},r.prototype.warn=function(t,e){this.logMessage(this.consoleLogger.warn.bind(this.consoleLogger),"WARN",t,e)},r.prototype.debug=function(t,e){this.logMessage(this.consoleLogger.debug.bind(this.consoleLogger),"DEBUG",t,e)},r.prototype.log=function(t,e){this.logMessage(this.consoleLogger.log.bind(this.consoleLogger),"LOG",t,e)},r.prototype.logMessage=function(t,e,r,n){this.canProcessLog()&&(e="".concat(this.icons[e]," [ROUTE][").concat(e,"] ").concat(r),n?t(e,n):t(e))},r.prototype.canProcessLog=function(){return window&&window.location&&window.location.href.includes("#route-debug")||window.localStorage&&"1"===window.localStorage.getItem("route-debug")},e.ConsoleLoggerAdapter=r},304:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.consoleLoggerAdapterFactory=void 0;var n=r(591);e.consoleLoggerAdapterFactory=function(){return{consoleLoggerAdapter:new n.ConsoleLoggerAdapter}}},936:function(t,e){var r=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},o=(Object.defineProperty(e,"__esModule",{value:!0}),e.MerchantRepository=void 0,i.prototype.getMerchantInfo=function(){return r(this,void 0,void 0,(function(){var t;return n(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,this.httpClient.get("".concat(this.shopifyServiceUrl,"/v1/merchant-info/").concat(this.shopifyDomain))];case 1:return[4,e.sent().json()];case 2:if(!(t=e.sent()).merchantId)throw new Error("Failed to fetch Merchant ID");if(t.storeName)return[2,Promise.resolve({merchantId:t.merchantId,storeName:t.storeName})];throw new Error("Failed to fetch Store Name");case 3:return t=e.sent(),console.log("Error when fetching Merchant Info",{error:t}),[2,null];case 4:return[2]}}))}))},i);function i(t){this.httpClient=t.httpClient,this.shopifyServiceUrl=t.shopifyServiceUrl,this.shopifyDomain=t.shopifyDomain}e.MerchantRepository=o},135:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r=r||Promise)((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):((e=t.value)instanceof r?e:new r((function(t){t(e)}))).then(a,u)}c((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){var s=[u,c];if(r)throw new TypeError("Generator is already executing.");for(;i=a&&s[a=0]?0:i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,(s=o?[2&s[0],o.value]:s)[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3]))i.label=s[1];else if(6===s[0]&&i.label<o[1])i.label=o[1],o=s;else{if(!(o&&i.label<o[2])){o[2]&&i.ops.pop(),i.trys.pop();continue}i.label=o[2],i.ops.push(s)}}s=e.call(t,i)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}},a=(Object.defineProperty(e,"__esModule",{value:!0}),e.ShopifyRepository=void 0,r(324));function u(t){this.httpClient=t.httpClient,this.storeDomain=t.storeDomain}u.prototype.getHeaders=function(){var t=this.storeDomain;return n(n({},{shop:t,"Content-type":"application/json;charset=UTF-8"}),{"X-Shopify-Domain":t})},u.prototype.getCart=function(){return o(this,void 0,void 0,(function(){var t,e;return i(this,(function(r){switch(r.label){case 0:t=(new Date).getTime(),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.httpClient.get("https://".concat(this.storeDomain,"/cart.js?timestamp=").concat(t))];case 2:return[4,r.sent().json()];case 3:return[2,{items:(e=r.sent()).items,itemsCount:e.item_count,subtotal:e.subtotal_price,currency:e.currency,itemsSubtotalPrice:e.items_subtotal_price,requiresShipping:e.requires_shipping,token:e.token,totalDiscount:e.total_discount,totalPrice:e.total_price,originalTotalPrice:e.original_total_price,attributes:e.attributes}];case 4:return e=r.sent(),console.log("Error getting cart",e),[2,void 0];case 5:return[2]}}))}))},u.prototype.updateCart=function(t){return o(this,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.httpClient.post("https://".concat(this.storeDomain,"/cart/update.js"),{body:JSON.stringify(t),headers:n({},this.getHeaders())})];case 1:return[2,r.sent().json()];case 2:return e=r.sent(),console.log("Error updating cart",e),[3,3];case 3:return[2]}}))}))},u.prototype.addCart=function(t){return o(this,void 0,void 0,(function(){var e;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.httpClient.post("https://".concat(this.storeDomain,"/cart/add.js"),{body:JSON.stringify(t),headers:n({},this.getHeaders())})];case 1:return[4,r.sent().json()];case 2:return[2,{items:r.sent().items}];case 3:return e=r.sent(),console.log("Error adding to cart",e),[2,{items:[]}];case 4:return[2]}}))}))},u.prototype.getRouteVariants=function(){return o(this,void 0,void 0,(function(){var t,e,r,n,o,u;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,this.httpClient.get("https://".concat(this.storeDomain,"/products/routeins.js"))];case 1:return[4,i.sent().json()];case 2:return o=i.sent(),t=o.variants,u=o.id,e=o.title,r=o.handle,n=o.vendor,o=o.price,[2,new a.Product(u,e,r,o,n,t).getProductVariants()];case 3:return u=i.sent(),console.log("Error getting route variants",u),[2,[]];case 4:return[2]}}))}))},e.ShopifyRepository=u},148:(t,e,r)=>{r.r(e),r.d(e,{createStore:()=>o,default:()=>i});const n=t=>{let e;const r=new Set;var n=(t,n)=>{if(t="function"==typeof t?t(e):t,!Object.is(t,e)){const o=e;e=(null!=n?n:"object"!=typeof t||null===t)?t:Object.assign({},e,t),r.forEach((t=>t(e,o)))}},o=()=>e,i={setState:n,getState:o,subscribe:t=>(r.add(t),()=>r.delete(t)),destroy:()=>{r.clear()}};return e=t(n,o,i),i},o=t=>t?n(t):n;var i=t=>o(t)},147:t=>{t.exports=JSON.parse('{"name":"@route/shopify-widget","version":"1.0.0","description":"","main":"index.js","scripts":{"start":"webpack serve --mode=development --config=webpack.common.config.js","test":"jest --config jest.config.ts --detectOpenHandles","pre:build":"rimraf dist","post:build":"rm -rf dist/src","build":"npm run pre:build && webpack --mode=production --config=webpack.production.config.js && npm run post:build","build:stage":"npm run pre:build && webpack --mode=development --config=webpack.common.config.js && rm -rf dist/src && npm run post:build","cy:build":"npm run pre:build && webpack --mode=production --config=webpack.production.config.js && cp -r dist/shopify.widget.js cypress/fixtures/shopify.widget.js","cy:run":"npm run cy:build && cypress run --browser electron --headless --config defaultCommandTimeout=10000","cy:open":"cypress open","test:e2e":"npm run cy:run"},"keywords":[],"author":"","license":"ISC","devDependencies":{"@jest/globals":"^29.6.1","@types/node":"^20.4.1","@types/webpack":"^5.28.1","@webpack-cli/generators":"^3.0.7","clean-webpack-plugin":"^4.0.0","copy-webpack-plugin":"^11.0.0","cypress":"^13.0.0","declaration-bundler-webpack-plugin":"^1.0.3","html-webpack-plugin":"^5.5.3","jest":"^29.6.1","jest-environment-jsdom":"^29.6.1","jest-fetch-mock":"^3.0.3","jsdom":"^22.1.0","rimraf":"^5.0.1","terser-webpack-plugin":"^5.3.9","ts-jest":"^29.1.1","ts-loader":"^9.4.4","ts-node":"^10.9.1","typescript":"^5.1.6","uglifyjs-webpack-plugin":"^2.2.0","webpack":"^5.88.1","webpack-dev-server":"^4.15.1","webpack-merge":"^5.9.0","wepack-cli":"^0.0.1-security"},"dependencies":{"zustand":"^4.3.9"}}')}},e={};function r(n){var o=e[n];return void 0!==o||(o=e[n]={exports:{}},t[n].call(o.exports,o,o.exports,r)),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(962)})();